<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>G-TELP ì±„ìš©ì •ë³´ í—ˆë¸Œ (ê´€ë¦¬ììš©)</title>
<style>
    body {
        font-family: 'Segoe UI', Tahoma, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: #333;
        min-height: 100vh;
        margin: 0;
        padding: 30px;
    }
    .container {
        max-width: 1200px;
        margin: 0 auto;
    }
    .header {
        text-align: center;
        color: white;
        margin-bottom: 30px;
    }
    .upload-box {
        background: white;
        padding: 40px;
        border-radius: 15px;
        border: 3px dashed #667eea;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s;
    }
    .upload-box:hover {
        background: #f8f9ff;
        border-color: #764ba2;
    }
    input[type=file] { display: none; }
    pre {
        background: white;
        border-radius: 10px;
        padding: 20px;
        overflow-x: auto;
        max-height: 400px;
        white-space: pre-wrap;
        word-break: break-all;
        box-shadow: 0 3px 15px rgba(0,0,0,0.1);
    }
    .btn {
        margin-top: 20px;
        padding: 10px 20px;
        border-radius: 8px;
        background: #667eea;
        color: white;
        border: none;
        font-weight: bold;
        cursor: pointer;
        transition: 0.3s;
    }
    .btn:hover {
        background: #5a6fe0;
    }
</style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>ğŸ› ï¸ G-TELP ì±„ìš©ì •ë³´ í—ˆë¸Œ (ê´€ë¦¬ììš©)</h1>
        <p>CSV ë˜ëŠ” Excel íŒŒì¼ì„ ì—…ë¡œë“œí•˜ë©´ JSONìœ¼ë¡œ ë³€í™˜ë©ë‹ˆë‹¤.</p>
    </div>

    <div class="upload-box" onclick="document.getElementById('fileInput').click()">
        <input type="file" id="fileInput" accept=".csv,.xlsx,.xls" onchange="handleFileUpload(event)">
        ğŸ“‚ ì—‘ì…€/CSV íŒŒì¼ ì—…ë¡œë“œ (CSV, XLSX, XLS)
    </div>

    <button class="btn" id="downloadBtn" style="display:none;" onclick="downloadJSON()">ğŸ“¥ JSON íŒŒì¼ë¡œ ì €ì¥</button>

    <pre id="jsonPreview">ì•„ì§ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</pre>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
let jsonData = [];

function handleFileUpload(event) {
    const file = event.target.files[0];
    if (!file) return;
    const reader = new FileReader();

    reader.onload = function(e) {
        let data;
        if (file.name.endsWith('.csv')) {
            data = parseCSV(e.target.result);
        } else {
            const workbook = XLSX.read(e.target.result, {type: 'binary'});
            const sheet = workbook.Sheets[workbook.SheetNames[0]];
            data = XLSX.utils.sheet_to_json(sheet, {raw: false, defval: ''});
        }

        jsonData = data.filter(r => Object.values(r).some(v => v && v.toString().trim()));
        document.getElementById('jsonPreview').textContent = JSON.stringify(jsonData, null, 2);
        document.getElementById('downloadBtn').style.display = 'inline-block';
    };

    if (file.name.endsWith('.csv')) reader.readAsText(file, 'UTF-8');
    else reader.readAsBinaryString(file);
}

function parseCSV(text) {
    const [headerLine, ...lines] = text.split('\n');
    const headers = headerLine.split(',').map(h => h.trim());
    return lines.filter(l => l.trim()).map(l => {
        const values = l.split(',');
        const obj = {};
        headers.forEach((h, i) => obj[h] = values[i] ? values[i].trim() : '');
        return obj;
    });
}

function downloadJSON() {
    const blob = new Blob([JSON.stringify(jsonData, null, 2)], {type: 'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'gtelp_data.json';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
}
</script>
</body>
</html>