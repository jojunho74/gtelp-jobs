<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>G-TELP ì±„ìš©ì •ë³´ í—ˆë¸Œ</title>
<style>
body{
  font-family:'Pretendard',-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;
  background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
  min-height:100vh;
  padding:20px;
  margin:0;
}
.container{
  max-width:1400px;
  margin:0 auto;
}
.header{
  background:white;
  padding:30px;
  border-radius:20px;
  box-shadow:0 10px 40px rgba(0,0,0,0.15);
  text-align:center;
  margin-bottom:30px;
}
.header h1{
  color:#667eea;
  font-size:2.5em;
  margin:0 0 10px 0;
  font-weight:700;
}
.header p{
  color:#666;
  font-size:1.1em;
  margin:0;
}
.stats{
  background:rgba(255,255,255,0.95);
  padding:15px 25px;
  border-radius:15px;
  margin-bottom:30px;
  display:flex;
  justify-content:center;
  gap:30px;
  flex-wrap:wrap;
  box-shadow:0 5px 20px rgba(0,0,0,0.1);
}
.stat-item{
  text-align:center;
}
.stat-number{
  font-size:2em;
  font-weight:700;
  color:#667eea;
  margin:0;
}
.stat-label{
  font-size:0.9em;
  color:#666;
  margin:5px 0 0 0;
}
.jobs-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(350px,1fr));
  gap:20px;
}
.job-card{
  background:white;
  padding:25px;
  border-radius:15px;
  box-shadow:0 5px 20px rgba(0,0,0,0.1);
  transition:all 0.3s ease;
  position:relative;
}
.job-card:hover{
  transform:translateY(-5px);
  box-shadow:0 8px 30px rgba(0,0,0,0.15);
}
.job-title{
  font-weight:600;
  color:#333;
  font-size:1.2em;
  margin-bottom:10px;
  line-height:1.4;
}
.job-company{
  color:#667eea;
  font-weight:600;
  margin:8px 0;
  font-size:1.05em;
}
.job-tags{
  margin:12px 0;
}
.job-tag{
  display:inline-block;
  background:#f0f4ff;
  color:#667eea;
  padding:6px 12px;
  border-radius:20px;
  font-size:0.85em;
  margin:4px 4px 4px 0;
  border:1px solid #e0e8ff;
}
.job-actions{
  margin-top:15px;
  display:flex;
  gap:10px;
  align-items:center;
}
.job-link{
  display:inline-block;
  background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
  color:white;
  padding:10px 20px;
  border-radius:25px;
  text-decoration:none;
  font-weight:600;
  transition:all 0.3s ease;
  box-shadow:0 3px 10px rgba(102,126,234,0.3);
}
.job-link:hover{
  transform:translateY(-2px);
  box-shadow:0 5px 15px rgba(102,126,234,0.4);
}
.job-link:active{
  transform:translateY(0);
}
.btn-disabled{
  display:inline-block;
  padding:10px 20px;
  border-radius:25px;
  background:#f5f5f5;
  color:#999;
  border:1px solid #ddd;
  font-weight:600;
  cursor:not-allowed;
}
.small-search{
  display:inline-block;
  padding:8px 16px;
  border-radius:20px;
  background:#f0f4ff;
  color:#667eea;
  text-decoration:none;
  border:1px solid #dfe8ff;
  font-weight:600;
  font-size:0.9em;
  transition:all 0.3s ease;
}
.small-search:hover{
  background:#667eea;
  color:white;
  border-color:#667eea;
}
.no-data{
  background:white;
  padding:60px 30px;
  border-radius:15px;
  text-align:center;
  box-shadow:0 5px 20px rgba(0,0,0,0.1);
  grid-column:1/-1;
}
.no-data h3{
  color:#333;
  font-size:1.5em;
  margin:0 0 10px 0;
}
.no-data p{
  color:#666;
  margin:0;
}
.relevance-badge{
  position:absolute;
  top:15px;
  right:15px;
  background:#ffd700;
  color:#333;
  padding:5px 10px;
  border-radius:15px;
  font-size:0.75em;
  font-weight:700;
  box-shadow:0 2px 5px rgba(0,0,0,0.1);
}
@media(max-width:768px){
  .jobs-grid{
    grid-template-columns:1fr;
  }
  .header h1{
    font-size:1.8em;
  }
  .stats{
    gap:15px;
  }
}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <h1>ğŸŒŸ G-TELP ì±„ìš©ì •ë³´ í—ˆë¸Œ</h1>
    <p>ì§€í…”í”„ ê´€ë ¨ ìµœì‹  ì±„ìš© ê³µê³ ë¥¼ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”</p>
  </div>

  <div class="stats" id="statsBar" style="display:none;">
    <div class="stat-item">
      <div class="stat-number" id="totalJobs">0</div>
      <div class="stat-label">ì „ì²´ ê³µê³ </div>
    </div>
    <div class="stat-item">
      <div class="stat-number" id="validLinks">0</div>
      <div class="stat-label">ë§í¬ ìˆìŒ</div>
    </div>
    <div class="stat-item">
      <div class="stat-number" id="highRelevance">0</div>
      <div class="stat-label">ê³ ê´€ë ¨ë„</div>
    </div>
  </div>

  <div class="jobs-grid" id="jobsGrid">
    <div class="no-data">
      <h3>ğŸ“‹ ì±„ìš©ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</h3>
      <p>ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.</p>
    </div>
  </div>
</div>

<script>
async function loadJobs(){
  const grid = document.getElementById('jobsGrid');
  const statsBar = document.getElementById('statsBar');
  
  try {
    const res = await fetch('gtelp_data.json', {
      cache: "no-store",
      headers: {
        'Content-Type': 'application/json'
      }
    });
    
    if(!res.ok) {
      throw new Error(`HTTP error! status: ${res.status}`);
    }
    
    const jobs = await res.json();
    
    if(!Array.isArray(jobs) || jobs.length === 0){
      throw new Error('ë°ì´í„°ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.');
    }

    console.log('âœ… ë¡œë“œëœ ë°ì´í„°:', jobs.length + 'ê°œ');
    console.log('ğŸ“‹ ì²« ë²ˆì§¸ ë°ì´í„° ìƒ˜í”Œ:', jobs[0]);

    // í†µê³„ ê³„ì‚°
    let validLinkCount = 0;
    let highRelevanceCount = 0;

    const jobsHtml = jobs.map((job, index) => {
      // í•„ë“œ ì¶”ì¶œ (ì‹¤ì œ CSV ì»¬ëŸ¼ëª… ìš°ì„ )
      const title = job.job_title || job.title || 'ì œëª© ì—†ìŒ';
      const company = job.company_name || job.company || 'íšŒì‚¬ëª… ë¯¸ìƒ';
      const location = job.location || 'ì „êµ­';
      const site = job.source_site || job.source || 'ì¶œì²˜ ë¯¸ìƒ';
      const salary = job.salary || '';
      const relevance = job.gtelp_relevance || job.relevance || '';
      const orgType = job.organization_type || job.orgType || '';

      // job_url í•„ë“œ ì¶”ì¶œ (ì—¬ëŸ¬ ê°€ëŠ¥ì„± ê³ ë ¤)
      let url = job.job_url || job.jobUrl || job.url || job.link || '';

      // URL ì •ë¦¬
      if(url){
        url = url.toString().trim();
        
        // ì´ë¯¸ http(s)ë¡œ ì‹œì‘í•˜ë©´ ê·¸ëŒ€ë¡œ ì‚¬ìš©
        if(!url.startsWith('http://') && !url.startsWith('https://')){
          // ë„ë©”ì¸ í˜•íƒœë©´ https:// ì¶”ê°€
          if(url.includes('.') || url.startsWith('/')){
            url = 'https://' + url.replace(/^\/+/, '');
          } else {
            // ë‹¨ìˆœ í…ìŠ¤íŠ¸ë©´ URLë¡œ ë³´ì§€ ì•ŠìŒ
            url = '';
          }
        }
      }

      // í†µê³„ ì§‘ê³„
      if(url) validLinkCount++;
      if(relevance && (relevance.includes('High') || relevance.includes('Very'))) highRelevanceCount++;

      // ê´€ë ¨ë„ ë°°ì§€
      let relevanceBadge = '';
      if(relevance && relevance.includes('Very High')){
        relevanceBadge = '<div class="relevance-badge">â­ ë§¤ìš° ë†’ìŒ</div>';
      } else if(relevance && relevance.includes('High')){
        relevanceBadge = '<div class="relevance-badge">âœ¨ ë†’ìŒ</div>';
      }

      // ë§í¬ HTML
      let linkHtml = '';
      if(url){
        linkHtml = `<a class="job-link" href="${escapeHtml(url)}" target="_blank" rel="noopener noreferrer">ğŸ”— ìì„¸íˆ ë³´ê¸°</a>`;
      } else {
        const searchTerm = encodeURIComponent(company + ' ' + title + ' ì±„ìš©');
        linkHtml = `
          <span class="btn-disabled">ë§í¬ ì—†ìŒ</span>
          <a class="small-search" href="https://www.google.com/search?q=${searchTerm}" target="_blank" rel="noopener noreferrer">ğŸ” ê²€ìƒ‰</a>
        `;
      }

      return `
        <div class="job-card">
          ${relevanceBadge}
          <div class="job-title">${escapeHtml(title)}</div>
          <div class="job-company">ğŸ¢ ${escapeHtml(company)}</div>
          <div class="job-tags">
            <span class="job-tag">ğŸ“ ${escapeHtml(location)}</span>
            <span class="job-tag">ğŸ’¼ ${escapeHtml(site)}</span>
            ${salary ? `<span class="job-tag">ğŸ’° ${escapeHtml(salary)}</span>` : ''}
            ${orgType ? `<span class="job-tag">ğŸ›ï¸ ${escapeHtml(orgType)}</span>` : ''}
          </div>
          <div class="job-actions">
            ${linkHtml}
          </div>
        </div>
      `;
    }).join('');

    grid.innerHTML = jobsHtml;

    // í†µê³„ í‘œì‹œ
    document.getElementById('totalJobs').textContent = jobs.length;
    document.getElementById('validLinks').textContent = validLinkCount;
    document.getElementById('highRelevance').textContent = highRelevanceCount;
    statsBar.style.display = 'flex';

    console.log('ğŸ“Š í†µê³„:');
    console.log('  - ì „ì²´ ê³µê³ :', jobs.length);
    console.log('  - ë§í¬ ìˆìŒ:', validLinkCount);
    console.log('  - ê³ ê´€ë ¨ë„:', highRelevanceCount);

  } catch(err){
    console.error('âŒ ì—ëŸ¬:', err);
    grid.innerHTML = `
      <div class="no-data">
        <h3>âš ï¸ ì±„ìš©ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤</h3>
        <p style="color:#666">
          ${err.message}<br><br>
          gtelp_data.json íŒŒì¼ì´ ê°™ì€ í´ë”ì— ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.
        </p>
      </div>
    `;
  }
}

function escapeHtml(text){
  const div = document.createElement('div');
  div.textContent = text || '';
  return div.innerHTML;
}

// í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
loadJobs();
</script>
</body>
</html>